# 14. Функция от случайной величины

$] \ (\Omega, \ \mathfrak{A}, \ \mathbb{P})$ - вероятностное пространство. $\xi \ -$ кси, случайная величина. $y = f(x)\ -$ некоторая функция.

Рассмотрим $\eta = f(\xi)$. Она также будет случайной величиной, если выполнится следующее условие:

$$\{\omega \in \Omega, \forall y \in \mathbb{R}^1: \{\omega: \eta(\omega) < y \} \in \mathfrak{A}, \ \eta (\omega) = f(\xi(\omega)).$$

## Функция от дискретной случайной величины

::: warning `fct` Факт
Если $\xi\ -$ дискретная, то $\eta = f(\xi)$ тоже дискретная.
:::

::: details `exm` Пример
| $\xi$ | -1 | 0 | 1 |
| :------: | :-------: | :-----------: | :-----: |
| $P_\xi$ | 0.5 | 0.1 | 0.4 |

| $\xi^2$ | 0 | 1 |
| :------: | :-------: | :-----------: |
| $P_\xi$ | 0.1 | 0.5+0.4=0.9 |

| $\eta = 10\xi+2$ | -8 | 2 | 12 |
| :------: | :-------: | :-----------: | :-----: |
| $P_\eta$ | 0.5 | 0.1 | 0.4 |
:::

::: tip `tip` Мое замечание 
Со знанием закона распределения дискретной случайной величины можно найти все ее характеристики.
:::

## Функция от непрерывной случайной величины

Пусть $\xi \ -$ непрерывная случайная величина с плотностью распределения $\rho_\xi(x)$, функция $y = f(x)$ дифференцируемая, тогда плотность распределения случайной величины $\eta = f(\xi):$
$$\rho_\eta(x) = \mathbb{F}_\eta ' (x) = \dfrac{d\mathbb{F}_\xi(f^{-|}(x))df^{-|}(x)}{df^{-|}(x)dx} = \rho_\xi(f^{-|}(x)) |\dfrac{df^{-|}(x)}{dx}|$$

::: details `exm` Пример
$\eta = a\xi + b$

$\Rightarrow \xi = \dfrac{\eta - b}{a}, \ \xi'= \dfrac{1}{a}$

Найдем плотность распределения $\eta:$

$\rho_\eta(x) = \rho_\xi(\dfrac{x-b}{a}) |\dfrac{1}{a}|$, поскольку неизвестно, что $a > 0$
:::

### Монотонно возрастающая функция

Для непрерывной монотонно возрастающей функции $y = f(x)$ существует обратная к ней $$x = f^{-|}(y).$$

::: warning `clm` Утверждение
Если $\eta = f(\xi)$ монотонно возрастает, то $F_\eta(x) = F_\xi(f^{-|}(x))$
::: details `prf` Доказательство
$\mathbb{F}_\eta(x) = \mathbb{P}(f(\xi) < x) = \mathbb{P}(\xi < f^{-|}(x)) = \mathbb{F}_\xi(f^{-|}(x))$
:::

::: warning `fct` Факт
$F_\xi(x) = \mathbb{P}(\xi < x)$ по определению функции распределения
:::

$\rho_\eta(x)$ можно найти путем дифференцирования функции распределения:

$\rho_\eta(x) = \mathbb{F}_\eta ' (x) = \dfrac{d\mathbb{F}_\xi(f^{-|}(x))df^{-|}(x)}{df^{-|}(x)dx} = \rho_\xi(f^{-|}(x)) \dfrac{df^{-|}(x)}{dx}$

### Монотонно убывающая функция

Для непрерывной монотонно убывающей функции $\mathbb{P}(\xi > f^{-|}(x))$

::: warning `clm` Утверждение
Если $\eta = f(\xi)$ монотонно убывает, то $F_\eta(x) = 1 - F_\xi(f^{-|}(x))$
::: details `prf` Доказательство
$\mathbb{F}_\eta(x) = \mathbb{P}(f(\xi) < x) = \mathbb{P}(\xi > f^{-|}(x)) 
= 1 - \mathbb{F}_\xi(f^{-|}(x))$
:::

$\rho_\eta(x) = \mathbb{F}_\eta ' (x) = -\dfrac{d\mathbb{F}_\xi(f^{-|}(x))df^{-|}(x)}{df^{-|}(x)dx} = -\rho_\xi(f^{-|}(x)) \dfrac{df^{-|}(x)}{dx}$

### Логарифмически нормальное распределение

::: info `def` Логарифмически нормальное распределение
Неотрицательная случайная величина $\eta = e^\xi$ имеет логнормальное (логарифмически нормальное) распределение, если обратная функция $\xi = \ln (\eta)$ распределена по нормальному закону с параметрами $N(a, \sigma)$.
:::

::: tip `tip` Мое замечание Используется для исследования:
- роста детей;
- переработки изделий на отказ;
- времени восстановления.
:::

Плотность случайной величины $\xi$ имеет вид:

$$\rho_\xi(x) = \dfrac{1}{\sigma\sqrt{2\pi}} \exp{-\dfrac{(x-a)^2}{2\sigma^2}}.$$

Пусть $x > 0,$ тогда $f^{-|}(x) = \ln x, \ \dfrac{df^{-|}(x)}{dx} = \dfrac{1}{x} \Rightarrow \rho_\eta(x) = \dfrac{1}{\sigma\sqrt{2\pi}} \exp{-\dfrac{(\ln x-a)^2}{2\sigma^2}}.$

При этом, если $x < 0,$ то $\rho_\eta(x) = 0$


### Равномерное распределение на отрезке [0, 1]

Пусть монотонно возрастающая функция распределения случайной величины $\xi$ имеет вид $\mathbb{F}_\xi(x) = \mathbb{F}(x)$. Рассмотрим $\eta = F(\xi),$ тогда:

$$\mathbb{F}_\eta(x) = 
\begin{cases}
    0, x < 0 \\
    \mathbb{F}(\mathbb{F}^{-|}(x)) = x, 0 \leq x \leq 1 \\
    1, x > 1
\end{cases}.$$

Полученная случайная величина равномерно распределена на отрезке [0, 1]. Этот результат имеет широкое применение для датчиков случайных чисел. Базовые датчики выдают равномерно распределенные случайные числа на отрезке [0, 1]. Обозначив датчик за $\eta,$ получаем $\xi = \mathbb{F}^{-|}(\eta) \ -$ значение случайной величины с функцией распределения $\mathbb{F}(x)$.

Пусть $\eta$ распределена по показательному закону с функцией распределения $\mathbb{F}_\eta(x) = 
\begin{cases}
    0, x < 0 \\
    1 - e^{-\lambda x}, x > 0
\end{cases}.$

$\xi = \mathbb{F}_\eta(x)$ имеет равномерное распределение на отрезке [0, 1]. При этом $x = 1 - e^{-\lambda y}$. Выразим $y = \dfrac{\ln(1-x)}{-\lambda} = -\dfrac{1}{\lambda} \ln (1 - x).$ 

Зная случайную величину, равномерно распределенную на отрезке [0, 1], можно вывести другую случайную величину, распределенную по другому закону.

::: tip `tip` Мое замечание 
Чтобы моделировать явления, нужны случайные величины, по возможности равномерно распределенные на отрезке [0, 1]. Но чтобы явление хорошо описывалось, нужно очень постараться :) 
:::

## Немонотонная функция

Если $y = f(x) \ -$ немонотонная функция, то 
$$\mathbb{F}_\eta(y) = \underset{i}{\sum} \underset{\Delta i (y)}{\int} \rho_\xi(x)dx,$$

где $\Delta i (y) \ -$ i-тый монотонный интервал на $Ox, \ f(x) < y$.

Плотность получается путем дифференцирования $\mathbb{F}_\eta(y)\ \text{по} \ y.$

Математическое ожидание: $\mathbb{M_\eta = \begin{cases}
    \overset{+\infty}{\underset{-\infty}{\int}} f(x) \rho_\xi(x) dx, \ \text{непрерывная случайная величина} \\
    \underset{k}{\sum} f(x_k)\mathbb{P}(\xi = x_k), \ \text{дискретная случайная величина}
\end{cases}}.$

Дисперсия: $\mathbb{D_\eta = \begin{cases}
    \overset{+\infty}{\underset{-\infty}{\int}} (f(x) - \mathbb{M}_\eta)^2 \ \rho_\xi(x) dx, \ \text{непрерывная случайная величина} \\
    \underset{k}{\sum} (f(x_k) - \mathbb{M}_\eta)^2 \ \mathbb{P}(\xi = x_k), \ \text{дискретная случайная величина}
\end{cases}}$