# 20. Функции от многомерных случайных величин

Будем рассматривать на примере двумерной случайной величины.

## Двумерная случайная величина

::: info `def` Двумерная случайная величина
Пара $(X, Y)$, где $X$ и $Y$ — случайные величины, определённые на одном вероятностном пространстве. Формально, $(X, Y)$ — это отображение из вероятностного пространства $(\Omega, \mathcal{A}, P)$ в двумерное пространство $\mathbb{R}^2$, где:

$X: \Omega \to \mathbb{R}$,
$Y: \Omega \to \mathbb{R}$.
:::

## Функция от двумерной случайной величины

Пусть задано вероятностное пространство $(\Omega, \mathfrak{A}, P)$.

$(\xi_1, \xi_2) -$ двумерная случайная величина.

$\eta = g(\xi_1, \xi_2) -$ **функция от случайного вектора** $-$ будет случайной величиной при:

$$\forall x: \{\omega:\eta(\omega) = g(\xi_1(\omega), \xi_2(\omega))< x\} \in \mathfrak{A}$$

К слову, если вектор $(\xi_1,\xi_2)$ дискретный, то значение функции от него тоже будет дискретной случайной величиной. А если вектор непрерыный, то и значение функции тоже будет непрерывной случайной величиной.

### Дискретный случай

Пусть $\xi_1, \xi_2 -$ Бернуллевские случайные величины со значениями $0,\ 1$.

Законы распределения:

|$\xi_1$|$0$|$1$ |
|:---|:---:|:---:|
|$P(\xi_1)$|$q$|$p$|

|$\xi_2$|$0$|$1$ |
|:---|:---:|:---:|
|$P(\xi_2)$|$q$|$p$|

Пусть $\eta = \xi_1 + \xi_2\ -$ число успехов в двух испытаниях. Построим закон распределения:
- $\eta = 0:$
    $g(0,0) = q \cdot q = q^2$
    *Вероятности перемножаются, потому что должны произойти оба события одновременно.*
- $\eta = 1:$ 
    $$\begin{cases} g(0,1) = q \cdot p = qp \\
    g(1,0) = p \cdot q = pq \end{cases} \Rightarrow pq+qp = 2pq$$
    *Результаты складываются, потому что может произойти или первый сценарий, или второй.*
- $\eta = 2:$
    $g(1,1) = p \cdot p = p^2$

|$\eta$|$0$|$1$|$2$|
|:---|:---:|:---:|:---:|
|$P(\eta)$|$q^2$|$2pq$|$p^2$|

### Непрерывный случай

#### Общая схема

Пусть $(\xi_1, \xi_2)\ -$ непрерыный двумерный случайный вектор, его плотность $\rho_{\xi_1, \xi_2}(x_1, x_2)$.

Если $\eta = g(\xi_1, \xi_2),$ то ее функция распределения:

$$\mathbb{F}_\eta(x) = {\underset{g(\xi_1, \xi_2)<x}{\iint}}\rho_{\xi_1, \xi_2}(x_1, x_2)dx_1dx_2.$$

#### Частный случай

$\eta = g(\xi_1, \xi_2) = \xi_1 + \xi_2 \Rightarrow x = x_1 + x_2.$ Вычислим функцию распределения:

$\mathbb{F}_\eta(x) = \overset{+\infty}{\underset{-\infty}{\int}}\bigg(\overset{x-x_1}{\underset{-\infty}{\int}}\rho_{\xi_1, \xi_2}(x_1, x_2)dx_2\bigg)dx_1$

Сделаем замену переменной:
$$\begin{bmatrix}
    x_2 = t - x_1 \\
    dx_2= dt
\end{bmatrix}$$

И получаем, что
$\mathbb{F}_\eta(x) = \overset{+\infty}{\underset{-\infty}{\int}}\bigg(\overset{x}{\underset{-\infty}{\int}}\rho_{\xi_1, \xi_2}(x_1, t - x_1)dt\bigg)dx_1.$

Изменим порядок интегрирования:

$\mathbb{F}_\eta(x) = \int_{-\infty}^{x} \bigg( \int_{-\infty}^{+\infty} \rho_{\xi_1, \xi_2}(x_1, t - x_1) \, dx_1 \bigg) dt.$

$\rho_\eta(x) = \int_{-\infty}^{+\infty} \rho_{\xi_1, \xi_2}(x_1, x - x_1) \, dx_1.$

Поменяем местами $x_1$ и $x_2:$

$\rho_\eta(x) = \int_{-\infty}^{+\infty} \rho_{\xi_1, \xi_2}(x - x_2, x_2) \, dx_2.$

## Независимые случайные величины и формулы свертки

### Непрерывный случай

Если непрерывные случайные велчины $(\xi_1, \xi_2)$, образующие вектор, являются независимыми, то их совместная плотность будет равняться произведению маргинальных плотносей.

В общем случае: $\rho_\eta(x) = \rho_{\xi_1}(x_1) \rho_{\xi_2}(x_2).$

::: danger `imp` Формулы свертки
$\rho_\eta(x) = \int_{-\infty}^{+\infty} \rho_{\xi_1}(x_1) \rho_{\xi_2}(x - x_1) \ dx_1.$
$\rho_\eta(x) = \int_{-\infty}^{+\infty} \rho_{\xi_2}(x_2), \rho_{\xi_1}(x - x_2) \ dx_2.$
:::

::: tip `tip` Мое замечание
А что, если $\eta = \xi_1 + \xi_2 + \xi_3?$ Тогда будет 2 интеграла. То есть, в общем случае при $\eta = \overset{n}{\underset{i = 1}{\sum}}\xi_i$ нам понадобятся $n-1$ интеграл.
:::

#### Пример с суммой случайных величин, распределенных по нормальному закону

Пусть $\xi_1, \xi_2\ -$ независимые случайные величины, распределенные по нормальному закону с параметрами 0,1 и плотностью $\rho(x) = \dfrac{1}{\sqrt{2\pi}} exp(-\dfrac{x^2}{2}),\ \eta = \xi_1 + \xi_2.$

$\rho_\eta(x) = \overset{+\infty}{\underset{-\infty}{\int}}\rho(x_1) \cdot \rho(x - x_1) dx_1 = \dfrac{1}{2\pi}\overset{+\infty}{\underset{-\infty}{\int}}exp(-x_1^2 + xx_1 - \dfrac{x^2}{4} - \dfrac{x^2}{4}) dx_1= \dfrac{1}{2\pi}\overset{+\infty}{\underset{-\infty}{\int}}exp(-(x_1 - \dfrac{x}{2})^2 - \dfrac{x^2}{4}) dx_1 = \dfrac{1}{2\pi} exp (-\dfrac{x^2}{4})\overset{+\infty}{\underset{-\infty}{\int}}exp(-(x_1 - \dfrac{x}{2})) dx_1 = \dfrac{1}{\sqrt{2}\sqrt{2\pi}} exp(-\dfrac{x^2}{2 \cdot (\sqrt{2})^2}) \cdot \dfrac{1}{\sqrt{2}\sqrt{2\pi}} \overset{+\infty}{\underset{-\infty}{\int}} exp\bigg(-\dfrac{(x_1 - \frac{x}{2})^2}{2 \cdot \frac{1}{2}}\bigg) dx_1 = \dfrac{1}{\sqrt{2}\sqrt{2\pi}} exp(-\dfrac{x^2}{2 \cdot (\sqrt{2})^2}) \cdot 1 = \dfrac{1}{\sqrt{2}\sqrt{2\pi}} exp(-\dfrac{x^2}{2 \cdot (\sqrt{2})^2}).$

Получается случайная величина, распределенная по нормальному закону с параметрами $a=0,\ \sigma = \sqrt{2}.$

::: tip `rmk` Замечание преподавателя
Если $\xi_1$ распределена по нормальному закону с параметрами $N(a_1, \sigma_1),\ \xi_2 \ \text{с} \ N(a_2, \sigma_2),$ то $\eta = \xi_1 + \xi_2$ распределена по $N(a_1+a_2, \sqrt{\sigma_1^2 + \sigma_2^2}).$
:::

#### Распределение Эрланга

Даны две случайные величины, распределенные по показательному закону с параметром $\lambda.$ Найти распределение их суммы.

::: details Текстовая задача
У двух бригад время ожидания распределено по показательному закону с параметром $\lambda,$ первую заявку обслуживает первая бригада. Найти время ожидания второй бригады.
:::



### Дискретный случай

Также существует аналог формул свертки для дискретных случайных величин.

Пусть $\xi_1 = \{x_i, p_i\}\ \forall i \in I,\ \xi_2 = \{y_j, q_j\}\ \forall j \in J.$

Тогда $\{\xi_1 + \xi_2 = x\} = \underset{i \in I}{\sum}\{ \xi_1 = x_i, \xi_2 = x - x_i \}.$

Эти события могут быть невозможными.

::: danger `imp` Формула свертки для дискретных случайных величин
$\mathbb{P}(\xi_1 + \xi_2 = x) = \underset{i \in I}{\sum}\mathbb{P} (\xi_1 = x_i, \xi_2 = x - x_i ).$
:::

Рассмотрим частный случай, когда дискретные случайные величины независимы.

::: danger `imp` Формула свертки для независимых дискретных случайных величин
$\mathbb{P}(\xi_1 + \xi_2 = x) = \underset{i \in I}{\sum}[\mathbb{P}(\xi_1 = x_i)\mathbb{P}(\xi_2 = x - x_i )].$

$\mathbb{P}(\xi_1 + \xi_2 = x) = \underset{j \in J}{\sum}[\mathbb{P}(\xi_1 = x - y_j)\mathbb{P}(\xi_2 = y_j )].$
:::
 
#### Пример с независимыми Пуассоновскими случайными величинами

::: warning `clm` Утверждение
Сумма двух независимых случайных величин, распределенных по закону Пуаасона, есть пуассоновская случайная величина с параметром из суммы складываемых параметров.
:::

Пусть $\xi_1$ с параметром $\lambda_1$, $\xi_2$ с параметром $\lambda_2\ -$ независимые дискретные случайные величины, распределенные по закону Пуассона.

$\eta = \xi_1 + \xi_2.$ Найдем $\mathbb{P}(\eta = k):$

По формуле свертки $\mathbb{P}(\eta = k) = \overset{\infty}{\underset{i = 0}{\sum}}\dfrac{\lambda_1^i}{i!}exp(-\lambda_1) \cdot \mathbb{P}(\xi_2 = k-i)$

Если мы возьмем $i > k,$ то $\mathbb{P}  = 0 \Rightarrow i \leq k\ (k - i \geq 0).$ Перепишем:

$$\mathbb{P}(\eta = k) = \overset{k}{\underset{i = 0}{\sum}}\dfrac{\lambda_1^i}{i!}exp(-\lambda_1) \cdot \dfrac{\lambda_2^{k-i}}{(k-i)!}exp(-\lambda_2) = exp(-(\lambda_1 + \lambda_2)) \dfrac{1}{k!} \overset{k}{\underset{i=0}{\sum}} \dfrac{k!}{i!(k-i)!} \lambda_1^i \lambda_2^{k-i} = \dfrac{(\lambda_1 + \lambda_2)^k}{k!}exp(-(\lambda_1 + \lambda_2))\$$

Получается случайная величина, распределенная по закону Пуассона с параметром $\lambda_1 + \lambda_2.$

$*\overset{k}{\underset{i=0}{\sum}} \dfrac{k!}{i!(k-i)!} \lambda_1^i \lambda_2^{k-i}\ -$ бином Ньютона.